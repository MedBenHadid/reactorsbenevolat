{% extends "@FOSUser/layout.html.twig" %}

{% block tilebar %}Register en tant que manager d'association{% endblock %}
{% block breadcrumbs %}Register en tant que manager d'association{% endblock %}

{% block fos_user_content %}

    <div class="container">


        <div class="row">
            <div class="col-md-4 col-md-offset-4">

                <!--Tab -->
                <div class="my-account style-1 margin-top-5 margin-bottom-40">
                    <ul class="tabs-nav">
                        <li><a href="#">Register en tant que manager d'association</a></li>
                    </ul>

                    <div class="tabs-container alt">
                        <!-- Register -->
                        <div class="tab-content" id="tab1">
                            {% trans_default_domain 'FOSUserBundle' %}
                            {{ form_start(form, {'method': 'post', 'action': path('admin_association_register'), 'attr': {'class': 'fos_user_registration_register', 'enctype': 'multipart/form-data'}}) }}
                            <p class="form-row form-row-wide">
                                <label for="cin">CIN:
                                    <i class="im im-icon-Male"></i>
                                    {{ form_widget(form.id, {'attr': {'id':'cin'}}) }}
                                </label>
                            </p>

                            <p class="form-row form-row-wide">
                                <label for="nom">Nom:
                                    <i class="im im-icon-Male"></i>
                                    {{ form_widget(form.nom, {'attr': {'id':'nom'}}) }}
                                </label>
                            </p>

                            <p class="form-row form-row-wide">
                                <label for="prenom">Prenom:
                                    <i class="im im-icon-Male"></i>
                                    {{ form_widget(form.prenom, {'attr': {'id':'prenom'}}) }}
                                </label>
                            </p>

                            <p class="form-row form-row-wide">
                                <label for="username">Username:
                                    <i class="im im-icon-Male"></i>
                                    {{ form_widget(form.username, {'attr': {'id':'username'}}) }}
                                </label>
                            </p>

                            <p class="form-row form-row-wide">
                                <label for="email">Email Address:
                                    <i class="im im-icon-Mail"></i>
                                    {{ form_widget(form.email, {'attr': {'id':'email'}}) }}
                                </label>
                            </p>

                            <p class="form-row form-row-wide">
                                <label for="password">Password:
                                    <i class="im im-icon-Lock-2"></i>
                                    {{ form_widget(form.plainPassword.first, {'attr': {'id':'password'}}) }}
                                </label>
                            </p>

                            <p class="form-row form-row-wide">
                                <label for="confirm_password">Repeat Password:
                                    <i class="im im-icon-Lock-2"></i>
                                    {{ form_widget(form.plainPassword.second, {'attr': {'id':'confirm_password'}}) }}
                                </label>
                            </p>

                            <p class="form-row form-row-wide">
                                <label for="telephone">Telephone:
                                    <i class="im-icon-Phone-2"></i>
                                    {{ form_widget(form.telephone, {'attr': {'id':'telephone'}}) }}
                                </label>
                            </p>

                            <p class="form-row form-row-wide">
                                <label for="adresse">Adresse:
                                    <i class="im-icon-Map-Marker2"></i>
                                    {{ form_widget(form.adresse, {'attr': {'id':'adresse'}}) }}
                                </label>
                            </p>

                            <p class="form-row form-row-wide">
                                <label for="dateNaisance">Date Naissance:

                                    {{ form_widget(form.dateNaissance, {'attr': {'id':'dateNaisance'}}) }}
                                </label>
                            </p>



                            <div>
                                <h1>Votre Agence : </h1>

                                <p class="form-row form-row-wide">
                                    <label for="password">Nom Agence:
                                        <i class="im im-icon-Lock-2"></i>
                                        <input type="text" name="nom_agence" placeholder="nom agence" required/>
                                    </label>
                                </p>
                                <p class="form-row form-row-wide">
                                    <label for="password">Telephone Agence:
                                        <i class="im im-icon-Lock-2"></i>
                                        <input type="number" name="tel_agence" placeholder="telephone agence" required/>
                                    </label>
                                </p>
                                <p class="form-row form-row-wide">
                                    <label for="password">Horaire Agence:
                                        <i class="im im-icon-Lock-2"></i>
                                        <input type="text" name="horaire_agence" placeholder="horaire agence" required/>
                                    </label>
                                </p>
                                <p class="form-row form-row-wide">
                                    <label for="password">Photo Agence:
                                        <div class="row">
                                            <div class="col-md-8">
                                                <input type="file" accept="image/*" name="photo_agence" id="photo_agence" placeholder="photo" onchange="onchangeImgAg()" required>
                                            </div>
                                            <div class="col-md-4">
                                                <img id="img_ag" class="img-circle" src="{{ asset('client/images/no_image.svg') }}" style="width: 100px; height: 100px; margin-top: -20px">
                                            </div>
                                        </div>
                                    </label>
                                </p>
                                <p class="form-row form-row-wide">
                                    <label for="password">Pi√©ce Justificatif:
                                        <i class="im im-icon-Lock-2"></i>
                                        <input type="file" accept=".pdf,.PDF,.doc,.docx" name="piece_agence" id="piece_agence" placeholder="piece" onchange="onchangePieceAg()" required>
                                        <!--img id="piece_ag" class="img-circle" src="{{ asset('images/no_image.svg') }}" style="width: 100px; height: 100px"-->
                                    </label>
                                </p>
                                <p class="form-row form-row-wide">
                                    <label for="password">Rue Agence:
                                        <i class="im im-icon-Lock-2"></i>
                                        <input type="text" name="rue_agence" placeholder="rue agence" required/>
                                    </label>
                                </p>
                                <p class="form-row form-row-wide">
                                    <label for="password">Ville Agence:
                                        <i class="im im-icon-Lock-2"></i>
                                        <input type="text" name="ville_agence" placeholder="ville agence" required/>
                                    </label>
                                </p>
                                <p class="form-row form-row-wide">
                                    <label for="password">Code Postale Agence:
                                        <i class="im im-icon-Lock-2"></i>
                                        <input type="number" name="code_postal_agence" placeholder="code postale agence" required/>
                                    </label>
                                </p>
                                <p class="form-row form-row-wide">
                                    <label for="password">Emplacement Agence:
                                        <div id="map" style="width: 500px; height: 300px; background-color: red"></div>
                                        <input type="hidden" name="lat_agence" id="lat_agence" value="0" />
                                        <input type="hidden" name="lng_agence" id="lng_agence" value="0" />
                                    </label>
                                </p>



                            </div>


                            <p class="form-row">
                                <input type="submit" class="button border fw margin-top-10" name="register" value="Register" />
                            </p>

                            {{ form_end(form) }}
                        </div>
                    </div>
                </div>
            </div>
        </div>









        <script src="{{ asset('assets/back/libs/jquery/dist/jquery.min.js') }}"></script>
        <script>
            function onchangeImgAg(){
                input = document.getElementById('photo_agence');
                file = input.files[0];
                console.log(file);

                fr = new FileReader();
                fr.onload = showImage;
                //fr.readAsText(file);
                fr.readAsDataURL(file);

                function showImage() {
                    $("#img_ag").attr("src",fr.result);
                }
            }

            function onchangePieceAg(){
                input = document.getElementById('piece_agence');
                file = input.files[0];
                console.log(file);

                fr = new FileReader();
                fr.onload = showImage;
                //fr.readAsText(file);
                fr.readAsDataURL(file);

                function showImage() {
                    $("#piece_ag").attr("src",fr.result);
                }
            }
        </script>

        <script>

            function initMap() {
                var myLatLng = {lat: 36.772315, lng: 10.0375315};

                var map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 10,
                    center: myLatLng
                });






                // Try HTML5 geolocation.
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(function(position) {
                        var pos = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };

                        map.setCenter(pos);
                        var marker = new google.maps.Marker({
                            position: pos,
                            map: map,
                            title: 'Emplacement Agence',
                            draggable: true
                        });
                        google.maps.event.addListener(marker, 'dragend', function(evt){
                            //$('#emplacement_lat').val(evt.latLng.lat());
                            //$('#emplacement_lng').val(evt.latLng.lng());
                            document.getElementById('lat_agence').value = evt.latLng.lat();
                            document.getElementById('lng_agence').value = evt.latLng.lng();
                            //document.getElementById('current').innerHTML = '<p>Marker dropped: Current Lat: ' + evt.latLng.lat().toFixed(3) + ' Current Lng: ' + evt.latLng.lng().toFixed(3) + '</p>';
                        });
                    }, function() {
                        //handleLocationError(true, infoWindow, map.getCenter());
                        var marker = new google.maps.Marker({
                            position: myLatLng,
                            map: map,
                            title: 'Emplacement Agence',
                            draggable: true
                        });
                        google.maps.event.addListener(marker, 'dragend', function(evt){
                            document.getElementById('lat_agence').value = evt.latLng.lat();
                            document.getElementById('lng_agence').value = evt.latLng.lng();
                            //document.getElementById('current').innerHTML = '<p>Marker dropped: Current Lat: ' + evt.latLng.lat().toFixed(3) + ' Current Lng: ' + evt.latLng.lng().toFixed(3) + '</p>';
                        });
                        alert('Error: The Geolocation service failed.');
                    });
                } else {
                    // Browser doesn't support Geolocation
                    //handleLocationError(false, infoWindow, map.getCenter());
                    var marker = new google.maps.Marker({
                        position: myLatLng,
                        map: map,
                        title: 'Emplacement Agence',
                        draggable: true
                    });
                    google.maps.event.addListener(marker, 'dragend', function(evt){
                        document.getElementById('lat_agence').value = evt.latLng.lat();
                        document.getElementById('lng_agence').value = evt.latLng.lng();
                        //document.getElementById('current').innerHTML = '<p>Marker dropped: Current Lat: ' + evt.latLng.lat().toFixed(3) + ' Current Lng: ' + evt.latLng.lng().toFixed(3) + '</p>';
                    });
                    alert('Error: The Geolocation service failed.');
                }

            }

            function handleLocationError(browserHasGeolocation, infoWindow, pos) {
                infoWindow.setPosition(pos);
                infoWindow.setContent(browserHasGeolocation ?
                    'Error: The Geolocation service failed.' :
                    'Error: Your browser doesn\'t support geolocation.');
            }

        </script>
        <script async defer
                src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD00UW-yFHi17pDyHLe19_ImRpo0ja5Q3k&callback=initMap">
        </script>
    </div>


{% endblock fos_user_content %}
